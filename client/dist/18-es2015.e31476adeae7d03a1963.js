(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{DPKD:function(t,e,r){"use strict";r.r(e),r.d(e,"ArchivedOrdersModule",function(){return R});var i=r("tyNb"),o=r("mrSG"),n=r("vkgz"),a=r("3Pt+"),s=r("GGDx"),c=r("cdsW"),l=r("r4zg"),d=r("fXoL"),u=r("ofXK"),b=r("bTqV");function p(t,e){if(1&t){const t=d.Rb();d.Qb(0,"button",1),d.Xb("click",function(){return d.nc(t),d.bc().onClick(1)}),d.wc(1,"UnArchive "),d.Pb()}}let h=(()=>{class t{agInit(t){this.params=t,this.isFileSet=null!=this.params.data.exportFile,this.value=+this.params.value}onClick(t){this.value=t,this.params.node.setDataValue(this.params.colDef,this.value)}refresh(){return!0}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=d.Fb({type:t,selectors:[["ct-archive-button"]],decls:1,vars:1,consts:[["mat-flat-button","","color","accent",3,"click",4,"ngIf"],["mat-flat-button","","color","accent",3,"click"]],template:function(t,e){1&t&&d.vc(0,p,2,0,"button",0),2&t&&d.gc("ngIf",!e.isFileSet)},directives:[u.k,b.a],styles:["button[_ngcontent-%COMP%] {\n          font-size: 12px !important;\n          height: 24px !important;\n          padding: 2px !important;\n          line-height: 12px !important;\n        }"]}),t})();var m=r("MOE4"),f=r("0IaG"),g=r("A9p3"),v=r("3LUQ"),w=r("Wp6s"),S=r("kmnG"),P=r("qFsG"),D=r("iadO"),M=r("STbY"),C=r("NFeN"),O=r("Qu3c"),k=r("gwh1");function F(t,e){if(1&t&&(d.Qb(0,"div",13),d.Mb(1,"ag-grid-angular",14),d.Pb()),2&t){const t=d.bc();d.Ab(1),d.gc("gridOptions",t.options)("modules",t.modules)("rowData",t.rowData)}}let A=(()=>{class t{constructor(t,e,r,i){this.ordersService=t,this.dialog=e,this.confirmService=r,this.alertService=i,this.orderDateForm=new a.f({orderDate:new a.d(l.a.now())}),this.orderStatus=0,this.rowData=[],this.modules=[],this.modules=[c.a],this.loadHeaders().subscribe(()=>{this.setupOptions()},t=>{console.log(t),this.onError("Could not load grid info")})}onGridReady(t){var e;this.gridApi=t.api,this.gridColumnApi=t.columnApi,this.addFilter({orderDate:{filter:l.a.toMysqlDate(this.orderDateForm.value.orderDate)}}),this.addFilter({orderStatus:{filter:l.a.orderStatus.ORDER_ARCHIVED}}),null===(e=this.gridApi)||void 0===e||e.setServerSideDatasource(this.ordersService),this.listenToOrderDateForm()}addFilter(t){if(this.gridApi){const e=this.gridApi.getFilterModel()?this.gridApi.getFilterModel():{};this.gridApi.setFilterModel(Object.assign(e,t))}}listenToOrderDateForm(){this.orderDateForm.valueChanges.subscribe(t=>{this.addFilter({orderDate:{filter:l.a.toMysqlDate(t.orderDate)}})})}loadHeaders(){return this.ordersService.getHeader().pipe(Object(n.a)(t=>{this.columns=t,this.columns[0].hide=!1,this.columns[0].editable=!0,this.columns[0].valueSetter=this.setValue.bind(this),this.columns[0].cellRenderer="archiveButtonRenderer"}))}setupOptions(){this.options={pagination:!1,tooltipShowDelay:0,defaultColDef:{sortable:!0,filter:!0,tooltipComponent:"tooltipRenderer",filterParams:{filterOptions:["contains"],defaultOption:"contains",suppressAndOrCondition:!0},resizable:!0,editable:!1},animateRows:!0,rowModelType:"serverSide",serverSideStoreType:"partial",rowSelection:"single",cacheBlockSize:100,columnDefs:this.columns,onGridReady:this.onGridReady.bind(this),paginationAutoPageSize:!0,frameworkComponents:{tooltipRenderer:s.a,archiveButtonRenderer:h}}}refresh(){this.gridApi.refreshServerSideStore({})}setValue(t){return Object(o.a)(this,void 0,void 0,function*(){const e={id:t.data.id,name:t.colDef.field,value:t.newValue};console.log(e),t.data[t.colDef.field]=t.newValue;const r=yield this.ordersService.updateCell(e);return(r.status?this.onSuccess.bind(this):this.onError.bind(this))(r.message),this.refresh(),r.status})}noRowSelected(){const t=this.gridApi?this.gridApi.getSelectedNodes():null;return!t||0===t.length}onSuccess(t){this.alertService.alertSuccess(t)}onError(t){this.alertService.alertError(t)}clearFilters(){this.orderDateForm.reset({orderDate:null}),this.gridApi.setFilterModel({orderStatus:{filter:l.a.orderStatus.ORDER_ARCHIVED}}),this.refresh()}}return t.\u0275fac=function(e){return new(e||t)(d.Lb(m.a),d.Lb(f.b),d.Lb(g.a),d.Lb(v.a))},t.\u0275cmp=d.Fb({type:t,selectors:[["ct-archived-orders"]],decls:31,vars:6,consts:[[1,"ct-toolbar","mat-elevation-z1"],[1,"ct-spacer"],[3,"formGroup"],[1,"ct-order-date"],["formControlName","orderDate","matInput","",3,"matDatepicker"],["matSuffix","",3,"for"],["picker",""],["mat-icon-button","",1,"ct-filter",3,"color","matMenuTriggerFor"],["mat-icon-button","","matTooltip","Refresh",3,"click"],["menu","matMenu"],["mat-menu-item","",3,"click"],["color","accent","mat-icon-button","","matTooltip","Reset Filters",3,"click"],["class","ct-table-wrapper",4,"ngIf"],[1,"ct-table-wrapper"],[1,"ag-theme-balham",3,"gridOptions","modules","rowData"]],template:function(t,e){if(1&t&&(d.Qb(0,"mat-card",0),d.Mb(1,"span",1),d.Qb(2,"div",2),d.Qb(3,"mat-form-field",3),d.Qb(4,"mat-label"),d.wc(5,"Choose a date"),d.Pb(),d.Mb(6,"input",4),d.Mb(7,"mat-datepicker-toggle",5),d.Mb(8,"mat-datepicker",null,6),d.Pb(),d.Pb(),d.Qb(10,"button",7),d.Qb(11,"mat-icon"),d.wc(12,"filter_alt"),d.Pb(),d.Pb(),d.Qb(13,"button",8),d.Xb("click",function(){return e.refresh()}),d.Qb(14,"mat-icon"),d.wc(15,"refresh"),d.Pb(),d.Pb(),d.Qb(16,"mat-menu",null,9),d.Qb(18,"button",10),d.Xb("click",function(){return e.orderStatus=0,e.refresh()}),d.Qb(19,"span"),d.wc(20,"Both"),d.Pb(),d.Pb(),d.Qb(21,"button",10),d.Xb("click",function(){return e.orderStatus=1,e.refresh()}),d.Qb(22,"span"),d.wc(23,"Pending"),d.Pb(),d.Pb(),d.Qb(24,"button",10),d.Xb("click",function(){return e.orderStatus=2,e.refresh()}),d.Qb(25,"span"),d.wc(26,"Queued"),d.Pb(),d.Pb(),d.Pb(),d.Qb(27,"button",11),d.Xb("click",function(){return e.clearFilters()}),d.Qb(28,"mat-icon"),d.wc(29,"cancel"),d.Pb(),d.Pb(),d.Pb(),d.vc(30,F,2,3,"div",12)),2&t){const t=d.lc(9),r=d.lc(17);d.Ab(2),d.gc("formGroup",e.orderDateForm),d.Ab(4),d.gc("matDatepicker",t),d.Ab(1),d.gc("for",t),d.Ab(3),d.gc("color",0!=e.orderStatus?"primary":"")("matMenuTriggerFor",r),d.Ab(20),d.gc("ngIf",e.columns)}},directives:[w.a,a.m,a.g,S.c,S.f,a.c,P.b,D.d,a.l,a.e,D.f,S.h,D.c,b.a,M.d,C.a,O.a,M.a,M.b,u.k,k.a],styles:[".ct-toolbar[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;width:100%;padding:0!important;margin:0!important}.ct-spacer[_ngcontent-%COMP%]{flex:1 1 auto}.mat-menu-item[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{margin-right:0!important}.ct-table-wrapper[_ngcontent-%COMP%]{width:100%;display:flex;position:relative}.ct-table-wrapper[_ngcontent-%COMP%]   ag-grid-angular[_ngcontent-%COMP%]{display:inline-block;flex:1 1 auto;height:calc(100vh - 118px)}.ct-table-wrapper[_ngcontent-%COMP%]   .ct-next-button[_ngcontent-%COMP%]{align-self:center}button[_ngcontent-%COMP%]{height:36px!important}button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px!important}.ct-order-date[_ngcontent-%COMP%]{height:36px;font-size:12px}"]}),t})();var Q=r("PCNd"),y=r("vvyD");let R=(()=>{class t{}return t.\u0275mod=d.Jb({type:t}),t.\u0275inj=d.Ib({factory:function(e){return new(e||t)},imports:[[u.c,Q.a,k.b.withComponents(),y.a,a.h,a.q,i.f.forChild([{path:"",component:A,pathMatch:"full"}])]]}),t})()}}]);