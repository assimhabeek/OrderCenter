(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{A9p3:function(t,e,o){"use strict";o.d(e,"a",function(){return l});var n=o("0IaG"),i=o("fXoL"),r=o("ofXK"),a=o("bTqV");function s(t,e){if(1&t&&(i.Pb(0),i.Rb(1,"h1",1),i.xc(2),i.Qb(),i.Rb(3,"div",2),i.Rb(4,"p"),i.xc(5),i.Qb(),i.Qb(),i.Rb(6,"div",3),i.Rb(7,"button",4),i.xc(8,"No"),i.Qb(),i.Rb(9,"button",5),i.xc(10,"Yes"),i.Qb(),i.Qb(),i.Ob()),2&t){const t=i.cc();i.Ab(2),i.yc(t.data.title),i.Ab(3),i.yc(t.data.description),i.Ab(2),i.hc("mat-dialog-close",!1),i.Ab(2),i.hc("mat-dialog-close",!0)}}let c=(()=>{class t{constructor(t){this.data=t}}return t.\u0275fac=function(e){return new(e||t)(i.Lb(n.a))},t.\u0275cmp=i.Fb({type:t,selectors:[["ct-confirm-dialog"]],decls:1,vars:1,consts:[[4,"ngIf"],["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions",""],["mat-button","","cdkFocusInitial","",3,"mat-dialog-close"],["mat-button","","color","warn",3,"mat-dialog-close"]],template:function(t,e){1&t&&i.wc(0,s,11,4,"ng-container",0),2&t&&i.hc("ngIf",e.data)},directives:[r.k,n.h,n.e,n.c,a.a,n.d],styles:[""]}),t})(),l=(()=>{class t{constructor(t){this.dialog=t}requestDeleteConfirmation(){return this.dialog.open(c,{data:{title:"Delete confirmation",description:"Are you sure you want to delete this row permanently."},disableClose:!0}).afterClosed()}requestConfirmation(t,e){return this.dialog.open(c,{data:{title:t,description:e},disableClose:!0}).afterClosed()}}return t.\u0275fac=function(e){return new(e||t)(i.Vb(n.b))},t.\u0275prov=i.Hb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},R5EJ:function(t,e,o){"use strict";o.r(e),o.d(e,"ExportHistoryModule",function(){return S});var n=o("tyNb"),i=o("Iab2"),r=o("fXoL"),a=o("AytR"),s=o("tk/3"),c=o("N+K7");let l=(()=>{class t{constructor(t){this.httpService=t}getHistory(){return this.httpService.getWithAuth(a.a.routes.history)}deleteRow(t){return this.httpService.deleteWithAuth(a.a.routes.history+"/"+t)}downloadFile(t){return this.httpService.getWithAuth(a.a.routes.files,{responseType:"blob",observe:"response",params:(new s.c).set("id",t.toString())})}}return t.\u0275fac=function(e){return new(e||t)(r.Vb(c.a))},t.\u0275prov=r.Hb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var d=o("3LUQ"),u=o("bTqV");let h=(()=>{class t{constructor(t,e){this.exportHistoryService=t,this.alertService=e}agInit(t){this.params=t,this.value=this.params.data.id}download(){this.exportHistoryService.downloadFile(this.value).subscribe(t=>{this.saveAsExcelFile(t.body,t.headers.get("x-file-name"))},t=>{this.alertService.alertError("Couldn't load file")})}refresh(t){return!0}saveAsExcelFile(t,e){const o=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});i.saveAs(o,e+"_export.xlsx")}}return t.\u0275fac=function(e){return new(e||t)(r.Lb(l),r.Lb(d.a))},t.\u0275cmp=r.Fb({type:t,selectors:[["ct-download-export-button"]],decls:2,vars:0,consts:[["mat-flat-button","","color","accent",3,"click"]],template:function(t,e){1&t&&(r.Rb(0,"button",0),r.Yb("click",function(){return e.download()}),r.xc(1,"Download "),r.Qb())},directives:[u.a],styles:["button[_ngcontent-%COMP%] {\n            font-size: 12px !important;\n            height: 24px !important;\n            padding: 2px !important;\n            line-height: 12px !important;\n        }"]}),t})();var p=o("0IaG"),b=o("A9p3"),m=o("Wp6s"),f=o("Qu3c"),g=o("NFeN"),v=o("ofXK"),w=o("cWTo");function y(t,e){if(1&t&&(r.Rb(0,"div",3),r.Mb(1,"ag-grid-angular",4),r.Qb()),2&t){const t=r.cc();r.Ab(1),r.hc("gridOptions",t.options)("modules",t.modules)("rowData",t.rowData)}}let x=(()=>{class t{constructor(t,e,o,n){this.historyService=t,this.dialog=e,this.confirmService=o,this.alertService=n,this.rowData=[],this.modules=[],this.defineHeader(),this.setupOptions()}onGridReady(t){this.gridApi=t.api,this.gridColumnApi=t.columnApi,this.refresh()}refresh(){this.historyService.getHistory().subscribe(t=>{t.status&&this.gridApi.setRowData(t.data)})}defineHeader(){this.columns=[{field:"download",cellRenderer:"archiveButtonDownload",headerName:"/"},{field:"fileName",headerName:"Name"},{field:"startDate",headerName:"From"},{field:"endDate",headerName:"To"},{field:"type",headerName:"Type"},{field:"exportedBy",headerName:"Exported By"}]}setupOptions(){this.options={pagination:!1,defaultColDef:{filter:!0,sortable:!0,editable:!1},animateRows:!0,rowSelection:"single",columnDefs:this.columns,onGridReady:this.onGridReady.bind(this),paginationAutoPageSize:!0,frameworkComponents:{archiveButtonDownload:h}}}noRowSelected(){const t=this.gridApi?this.gridApi.getSelectedNodes():null;return!t||0===t.length}onRemove(){const t=this.gridApi.getSelectedNodes();if(!t||0===t.length)return;const e=t[0];this.confirmService.requestConfirmation("Delete confirmation","Are you sure you want to delete this record, All related orders will remain achieved  If you want to edit them need to unarchive them manually ").subscribe(t=>{t&&this.removeRow(e)})}removeRow(t){this.historyService.deleteRow(+t.data.id).subscribe(t=>{t.status?(this.gridApi.deselectAll(),this.refresh(),this.onSuccess(t.message)):(console.log(t),this.onError(t.message))})}onSuccess(t){this.alertService.alertSuccess(t)}onError(t){this.alertService.alertError(t),this.refresh()}}return t.\u0275fac=function(e){return new(e||t)(r.Lb(l),r.Lb(p.b),r.Lb(b.a),r.Lb(d.a))},t.\u0275cmp=r.Fb({type:t,selectors:[["ct-skus-list"]],decls:5,vars:2,consts:[[1,"ct-toolbar","mat-elevation-z1"],["mat-icon-button","","matTooltip","Remove","color","warn",3,"disabled","click"],["class","ct-table-wrapper",4,"ngIf"],[1,"ct-table-wrapper"],[1,"ag-theme-balham",3,"gridOptions","modules","rowData"]],template:function(t,e){1&t&&(r.Rb(0,"mat-card",0),r.Rb(1,"button",1),r.Yb("click",function(){return e.onRemove()}),r.Rb(2,"mat-icon"),r.xc(3,"delete"),r.Qb(),r.Qb(),r.Qb(),r.wc(4,y,2,3,"div",2)),2&t&&(r.Ab(1),r.hc("disabled",e.noRowSelected()),r.Ab(3),r.hc("ngIf",e.columns))},directives:[m.a,u.a,f.a,g.a,v.k,w.a],styles:[".ct-toolbar[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;width:100%;padding:0!important;margin:0!important}.ct-spacer[_ngcontent-%COMP%]{flex:1 1 auto}.mat-menu-item[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{margin-right:0!important}.ct-table-wrapper[_ngcontent-%COMP%]{width:100%;display:flex;position:relative}.ct-table-wrapper[_ngcontent-%COMP%]   ag-grid-angular[_ngcontent-%COMP%]{display:inline-block;flex:1 1 auto;height:calc(100vh - 118px)}.ct-table-wrapper[_ngcontent-%COMP%]   .ct-next-button[_ngcontent-%COMP%]{align-self:center}button[_ngcontent-%COMP%]{height:36px!important}button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px!important}.ct-order-date[_ngcontent-%COMP%]{height:36px;font-size:12px}"]}),t})();var A=o("PCNd"),C=o("vvyD"),R=o("3Pt+");let S=(()=>{class t{}return t.\u0275mod=r.Jb({type:t}),t.\u0275inj=r.Ib({factory:function(e){return new(e||t)},imports:[[v.c,A.a,w.b.withComponents(),C.a,R.h,R.q,n.e.forChild([{path:"",component:x,pathMatch:"full"}])]]}),t})()}}]);