(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{R5EJ:function(e,t,o){"use strict";o.r(t),o.d(t,"ExportHistoryModule",function(){return P});var n=o("tyNb"),i=o("fXoL"),r=o("AytR"),a=o("tk/3"),s=o("N+K7");let c=(()=>{class e{constructor(e){this.httpService=e}getHistory(){return this.httpService.getWithAuth(r.a.routes.history)}deleteRow(e){return this.httpService.deleteWithAuth(r.a.routes.history+"/"+e)}downloadFile(e){return this.httpService.getWithAuth(r.a.routes.files,{responseType:"blob",observe:"response",params:(new a.c).set("id",e.toString())})}}return e.\u0275fac=function(t){return new(t||e)(i.Ub(s.a))},e.\u0275prov=i.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var l=o("3LUQ"),d=o("bTqV");let h=(()=>{class e{constructor(e,t){this.exportHistoryService=e,this.alertService=t}agInit(e){this.params=e,this.value=this.params.data.id}download(){this.exportHistoryService.downloadFile(this.value).subscribe(e=>{this.saveAsExcelFile(e.body,e.headers.get("x-file-name"))},()=>{this.alertService.alertError("Couldn't load file")})}refresh(){return!0}saveAsExcelFile(e,t){const o=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});this.save(o,t+"_export.xlsx")}save(e,t){const o=document.createElement("a");o.setAttribute("href",(window.webkitURL||window.URL).createObjectURL(e)),o.setAttribute("download",t),o.dataset.downloadurl=["text/plain",o.download,o.href].join(":"),o.style.display="none",document.body.appendChild(o),o.click(),document.body.removeChild(o)}}return e.\u0275fac=function(t){return new(t||e)(i.Lb(c),i.Lb(l.a))},e.\u0275cmp=i.Fb({type:e,selectors:[["ct-download-export-button"]],decls:2,vars:0,consts:[["mat-flat-button","","color","accent",3,"click"]],template:function(e,t){1&e&&(i.Qb(0,"button",0),i.Xb("click",function(){return t.download()}),i.wc(1,"Download "),i.Pb())},directives:[d.a],styles:["button[_ngcontent-%COMP%] {\n            font-size: 12px !important;\n            height: 24px !important;\n            padding: 2px !important;\n            line-height: 12px !important;\n        }"]}),e})();var p=o("sspt"),u=o("0IaG"),m=o("A9p3"),b=o("Wp6s"),f=o("Qu3c"),g=o("NFeN"),w=o("ofXK"),v=o("gwh1");function y(e,t){if(1&e&&(i.Qb(0,"div",3),i.Mb(1,"ag-grid-angular",4),i.Pb()),2&e){const e=i.bc();i.Ab(1),i.gc("gridOptions",e.options)("modules",e.modules)("rowData",e.rowData)}}let x=(()=>{class e{constructor(e,t,o,n){this.historyService=e,this.dialog=t,this.confirmService=o,this.alertService=n,this.rowData=[],this.modules=[p.a],this.defineHeader(),this.setupOptions()}onGridReady(e){this.gridApi=e.api,this.gridColumnApi=e.columnApi,this.refresh()}refresh(){this.historyService.getHistory().subscribe(e=>{e.status&&this.gridApi.setRowData(e.data)})}defineHeader(){this.columns=[{field:"download",cellRenderer:"archiveButtonDownload",headerName:"/"},{field:"fileName",headerName:"Name"},{field:"startDate",headerName:"From"},{field:"endDate",headerName:"To"},{field:"type",headerName:"Type"},{field:"exportedBy",headerName:"Exported By"}]}setupOptions(){this.options={pagination:!1,defaultColDef:{filter:!0,sortable:!0,editable:!1},animateRows:!0,rowSelection:"single",columnDefs:this.columns,onGridReady:this.onGridReady.bind(this),paginationAutoPageSize:!0,frameworkComponents:{archiveButtonDownload:h}}}noRowSelected(){const e=this.gridApi?this.gridApi.getSelectedNodes():null;return!e||0===e.length}onRemove(){const e=this.gridApi.getSelectedNodes();if(!e||0===e.length)return;const t=e[0];this.confirmService.requestConfirmation("Delete confirmation","Are you sure you want to delete this record, All related orders will remain achieved  If you want to edit them need to unarchive them manually ").subscribe(e=>{e&&this.removeRow(t)})}removeRow(e){this.historyService.deleteRow(+e.data.id).subscribe(e=>{e.status?(this.gridApi.deselectAll(),this.refresh(),this.onSuccess(e.message)):(console.log(e),this.onError(e.message))})}onSuccess(e){this.alertService.alertSuccess(e)}onError(e){this.alertService.alertError(e),this.refresh()}}return e.\u0275fac=function(t){return new(t||e)(i.Lb(c),i.Lb(u.b),i.Lb(m.a),i.Lb(l.a))},e.\u0275cmp=i.Fb({type:e,selectors:[["ct-skus-list"]],decls:5,vars:2,consts:[[1,"ct-toolbar","mat-elevation-z1"],["color","warn","mat-icon-button","","matTooltip","Remove",3,"disabled","click"],["class","ct-table-wrapper",4,"ngIf"],[1,"ct-table-wrapper"],[1,"ag-theme-balham",3,"gridOptions","modules","rowData"]],template:function(e,t){1&e&&(i.Qb(0,"mat-card",0),i.Qb(1,"button",1),i.Xb("click",function(){return t.onRemove()}),i.Qb(2,"mat-icon"),i.wc(3,"delete"),i.Pb(),i.Pb(),i.Pb(),i.vc(4,y,2,3,"div",2)),2&e&&(i.Ab(1),i.gc("disabled",t.noRowSelected()),i.Ab(3),i.gc("ngIf",t.columns))},directives:[b.a,d.a,f.a,g.a,w.k,v.a],styles:[".ct-toolbar[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;width:100%;padding:0!important;margin:0!important}.ct-spacer[_ngcontent-%COMP%]{flex:1 1 auto}.mat-menu-item[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{margin-right:0!important}.ct-table-wrapper[_ngcontent-%COMP%]{width:100%;display:flex;position:relative}.ct-table-wrapper[_ngcontent-%COMP%]   ag-grid-angular[_ngcontent-%COMP%]{display:inline-block;flex:1 1 auto;height:calc(100vh - 118px)}.ct-table-wrapper[_ngcontent-%COMP%]   .ct-next-button[_ngcontent-%COMP%]{align-self:center}button[_ngcontent-%COMP%]{height:36px!important}button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px!important}.ct-order-date[_ngcontent-%COMP%]{height:36px;font-size:12px}"]}),e})();var S=o("PCNd"),A=o("vvyD"),C=o("3Pt+");let P=(()=>{class e{}return e.\u0275mod=i.Jb({type:e}),e.\u0275inj=i.Ib({factory:function(t){return new(t||e)},imports:[[w.c,S.a,v.b.withComponents(),A.a,C.h,C.q,n.e.forChild([{path:"",component:x,pathMatch:"full"}])]]}),e})()}}]);