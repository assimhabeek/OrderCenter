!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function n(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{R5EJ:function(t,o,i){"use strict";i.r(o),i.d(o,"ExportHistoryModule",function(){return _});var a,r,c=i("tyNb"),s=i("fXoL"),l=i("AytR"),u=i("tk/3"),d=i("N+K7"),h=((a=function(){function t(n){e(this,t),this.httpService=n}return n(t,[{key:"getHistory",value:function(){return this.httpService.getWithAuth(l.a.routes.history)}},{key:"deleteRow",value:function(e){return this.httpService.deleteWithAuth(l.a.routes.history+"/"+e)}},{key:"downloadFile",value:function(e){return this.httpService.getWithAuth(l.a.routes.files,{responseType:"blob",observe:"response",params:(new u.c).set("id",e.toString())})}}]),t}()).\u0275fac=function(e){return new(e||a)(s.Ub(d.a))},a.\u0275prov=s.Hb({token:a,factory:a.\u0275fac,providedIn:"root"}),a),p=i("3LUQ"),f=i("bTqV"),m=((r=function(){function t(n,o){e(this,t),this.exportHistoryService=n,this.alertService=o}return n(t,[{key:"agInit",value:function(e){this.params=e,this.value=this.params.data.id}},{key:"download",value:function(){var e=this;this.exportHistoryService.downloadFile(this.value).subscribe(function(t){e.saveAsExcelFile(t.body,t.headers.get("x-file-name"))},function(){e.alertService.alertError("Couldn't load file")})}},{key:"refresh",value:function(){return!0}},{key:"saveAsExcelFile",value:function(e,t){var n=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});this.save(n,t+"_export.xlsx")}},{key:"save",value:function(e,t){var n=document.createElement("a");n.setAttribute("href",(window.webkitURL||window.URL).createObjectURL(e)),n.setAttribute("download",t),n.dataset.downloadurl=["text/plain",n.download,n.href].join(":"),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}}]),t}()).\u0275fac=function(e){return new(e||r)(s.Lb(h),s.Lb(p.a))},r.\u0275cmp=s.Fb({type:r,selectors:[["ct-download-export-button"]],decls:2,vars:0,consts:[["mat-flat-button","","color","accent",3,"click"]],template:function(e,t){1&e&&(s.Qb(0,"button",0),s.Xb("click",function(){return t.download()}),s.wc(1,"Download "),s.Pb())},directives:[f.a],styles:["button[_ngcontent-%COMP%] {\n            font-size: 12px !important;\n            height: 24px !important;\n            padding: 2px !important;\n            line-height: 12px !important;\n        }"]}),r),b=i("sspt"),v=i("0IaG"),g=i("A9p3"),w=i("Wp6s"),y=i("Qu3c"),k=i("NFeN"),x=i("ofXK"),S=i("gwh1");function C(e,t){if(1&e&&(s.Qb(0,"div",3),s.Mb(1,"ag-grid-angular",4),s.Pb()),2&e){var n=s.bc();s.Ab(1),s.gc("gridOptions",n.options)("modules",n.modules)("rowData",n.rowData)}}var A,P,O=((A=function(){function t(n,o,i,a){e(this,t),this.historyService=n,this.dialog=o,this.confirmService=i,this.alertService=a,this.rowData=[],this.modules=[b.a],this.defineHeader(),this.setupOptions()}return n(t,[{key:"onGridReady",value:function(e){this.gridApi=e.api,this.gridColumnApi=e.columnApi,this.refresh()}},{key:"refresh",value:function(){var e=this;this.historyService.getHistory().subscribe(function(t){t.status&&e.gridApi.setRowData(t.data)})}},{key:"defineHeader",value:function(){this.columns=[{field:"download",cellRenderer:"archiveButtonDownload",headerName:"/"},{field:"fileName",headerName:"Name"},{field:"startDate",headerName:"From"},{field:"endDate",headerName:"To"},{field:"type",headerName:"Type"},{field:"exportedBy",headerName:"Exported By"}]}},{key:"setupOptions",value:function(){this.options={pagination:!1,defaultColDef:{filter:!0,sortable:!0,editable:!1},animateRows:!0,rowSelection:"single",columnDefs:this.columns,onGridReady:this.onGridReady.bind(this),paginationAutoPageSize:!0,frameworkComponents:{archiveButtonDownload:m}}}},{key:"noRowSelected",value:function(){var e=this.gridApi?this.gridApi.getSelectedNodes():null;return!e||0===e.length}},{key:"onRemove",value:function(){var e=this,t=this.gridApi.getSelectedNodes();if(t&&0!==t.length){var n=t[0];this.confirmService.requestConfirmation("Delete confirmation","Are you sure you want to delete this record, All related orders will remain achieved  If you want to edit them need to unarchive them manually ").subscribe(function(t){t&&e.removeRow(n)})}}},{key:"removeRow",value:function(e){var t=this;this.historyService.deleteRow(+e.data.id).subscribe(function(e){e.status?(t.gridApi.deselectAll(),t.refresh(),t.onSuccess(e.message)):(console.log(e),t.onError(e.message))})}},{key:"onSuccess",value:function(e){this.alertService.alertSuccess(e)}},{key:"onError",value:function(e){this.alertService.alertError(e),this.refresh()}}]),t}()).\u0275fac=function(e){return new(e||A)(s.Lb(h),s.Lb(v.b),s.Lb(g.a),s.Lb(p.a))},A.\u0275cmp=s.Fb({type:A,selectors:[["ct-skus-list"]],decls:5,vars:2,consts:[[1,"ct-toolbar","mat-elevation-z1"],["color","warn","mat-icon-button","","matTooltip","Remove",3,"disabled","click"],["class","ct-table-wrapper",4,"ngIf"],[1,"ct-table-wrapper"],[1,"ag-theme-balham",3,"gridOptions","modules","rowData"]],template:function(e,t){1&e&&(s.Qb(0,"mat-card",0),s.Qb(1,"button",1),s.Xb("click",function(){return t.onRemove()}),s.Qb(2,"mat-icon"),s.wc(3,"delete"),s.Pb(),s.Pb(),s.Pb(),s.vc(4,C,2,3,"div",2)),2&e&&(s.Ab(1),s.gc("disabled",t.noRowSelected()),s.Ab(3),s.gc("ngIf",t.columns))},directives:[w.a,f.a,y.a,k.a,x.k,S.a],styles:[".ct-toolbar[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;width:100%;padding:0!important;margin:0!important}.ct-spacer[_ngcontent-%COMP%]{flex:1 1 auto}.mat-menu-item[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{margin-right:0!important}.ct-table-wrapper[_ngcontent-%COMP%]{width:100%;display:flex;position:relative}.ct-table-wrapper[_ngcontent-%COMP%]   ag-grid-angular[_ngcontent-%COMP%]{display:inline-block;flex:1 1 auto;height:calc(100vh - 118px)}.ct-table-wrapper[_ngcontent-%COMP%]   .ct-next-button[_ngcontent-%COMP%]{align-self:center}button[_ngcontent-%COMP%]{height:36px!important}button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px!important}.ct-order-date[_ngcontent-%COMP%]{height:36px;font-size:12px}"]}),A),R=i("PCNd"),M=i("vvyD"),N=i("3Pt+"),_=((P=function t(){e(this,t)}).\u0275mod=s.Jb({type:P}),P.\u0275inj=s.Ib({factory:function(e){return new(e||P)},imports:[[x.c,R.a,S.b.withComponents(),M.a,N.h,N.q,c.g.forChild([{path:"",component:O,pathMatch:"full"}])]]}),P)}}])}();