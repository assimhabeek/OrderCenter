(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{R5EJ:function(t,e,o){"use strict";o.r(e),o.d(e,"ExportHistoryModule",function(){return P});var n=o("tyNb"),i=o("fXoL"),r=o("AytR"),a=o("tk/3"),s=o("N+K7");let c=(()=>{class t{constructor(t){this.httpService=t}getHistory(){return this.httpService.getWithAuth(r.a.routes.history)}deleteRow(t){return this.httpService.deleteWithAuth(r.a.routes.history+"/"+t)}downloadFile(t){return this.httpService.getWithAuth(r.a.routes.files,{responseType:"blob",observe:"response",params:(new a.c).set("id",t.toString())})}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(s.a))},t.\u0275prov=i.Hb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var l=o("3LUQ"),d=o("bTqV");let h=(()=>{class t{constructor(t,e){this.exportHistoryService=t,this.alertService=e}agInit(t){this.params=t,this.value=this.params.data.id}download(){this.exportHistoryService.downloadFile(this.value).subscribe(t=>{this.saveAsExcelFile(t.body,t.headers.get("x-file-name"))},()=>{this.alertService.alertError("Couldn't load file")})}refresh(){return!0}saveAsExcelFile(t,e){const o=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});this.save(o,e+"_export.xlsx")}save(t,e){const o=document.createElement("a");o.setAttribute("href",(window.webkitURL||window.URL).createObjectURL(t)),o.setAttribute("download",e),o.dataset.downloadurl=["text/plain",o.download,o.href].join(":"),o.style.display="none",document.body.appendChild(o),o.click(),document.body.removeChild(o)}}return t.\u0275fac=function(e){return new(e||t)(i.Lb(c),i.Lb(l.a))},t.\u0275cmp=i.Fb({type:t,selectors:[["ct-download-export-button"]],decls:2,vars:0,consts:[["mat-flat-button","","color","accent",3,"click"]],template:function(t,e){1&t&&(i.Qb(0,"button",0),i.Xb("click",function(){return e.download()}),i.wc(1,"Download "),i.Pb())},directives:[d.a],styles:["button[_ngcontent-%COMP%] {\n            font-size: 12px !important;\n            height: 24px !important;\n            padding: 2px !important;\n            line-height: 12px !important;\n        }"]}),t})();var p=o("sspt"),u=o("0IaG"),m=o("A9p3"),b=o("Wp6s"),f=o("Qu3c"),g=o("NFeN"),w=o("ofXK"),v=o("gwh1");function y(t,e){if(1&t&&(i.Qb(0,"div",3),i.Mb(1,"ag-grid-angular",4),i.Pb()),2&t){const t=i.bc();i.Ab(1),i.gc("gridOptions",t.options)("modules",t.modules)("rowData",t.rowData)}}let x=(()=>{class t{constructor(t,e,o,n){this.historyService=t,this.dialog=e,this.confirmService=o,this.alertService=n,this.rowData=[],this.modules=[p.a],this.defineHeader(),this.setupOptions()}onGridReady(t){this.gridApi=t.api,this.gridColumnApi=t.columnApi,this.refresh()}refresh(){this.historyService.getHistory().subscribe(t=>{t.status&&this.gridApi.setRowData(t.data)})}defineHeader(){this.columns=[{field:"download",cellRenderer:"archiveButtonDownload",headerName:"/"},{field:"fileName",headerName:"Name"},{field:"startDate",headerName:"From"},{field:"endDate",headerName:"To"},{field:"type",headerName:"Type"},{field:"exportedBy",headerName:"Exported By"}]}setupOptions(){this.options={pagination:!1,defaultColDef:{filter:!0,sortable:!0,editable:!1},animateRows:!0,rowSelection:"single",columnDefs:this.columns,onGridReady:this.onGridReady.bind(this),paginationAutoPageSize:!0,frameworkComponents:{archiveButtonDownload:h}}}noRowSelected(){const t=this.gridApi?this.gridApi.getSelectedNodes():null;return!t||0===t.length}onRemove(){const t=this.gridApi.getSelectedNodes();if(!t||0===t.length)return;const e=t[0];this.confirmService.requestConfirmation("Delete confirmation","Are you sure you want to delete this record, All related orders will remain achieved  If you want to edit them need to unarchive them manually ").subscribe(t=>{t&&this.removeRow(e)})}removeRow(t){this.historyService.deleteRow(+t.data.id).subscribe(t=>{t.status?(this.gridApi.deselectAll(),this.refresh(),this.onSuccess(t.message)):(console.log(t),this.onError(t.message))})}onSuccess(t){this.alertService.alertSuccess(t)}onError(t){this.alertService.alertError(t),this.refresh()}}return t.\u0275fac=function(e){return new(e||t)(i.Lb(c),i.Lb(u.b),i.Lb(m.a),i.Lb(l.a))},t.\u0275cmp=i.Fb({type:t,selectors:[["ct-skus-list"]],decls:5,vars:2,consts:[[1,"ct-toolbar","mat-elevation-z1"],["color","warn","mat-icon-button","","matTooltip","Remove",3,"disabled","click"],["class","ct-table-wrapper",4,"ngIf"],[1,"ct-table-wrapper"],[1,"ag-theme-balham",3,"gridOptions","modules","rowData"]],template:function(t,e){1&t&&(i.Qb(0,"mat-card",0),i.Qb(1,"button",1),i.Xb("click",function(){return e.onRemove()}),i.Qb(2,"mat-icon"),i.wc(3,"delete"),i.Pb(),i.Pb(),i.Pb(),i.vc(4,y,2,3,"div",2)),2&t&&(i.Ab(1),i.gc("disabled",e.noRowSelected()),i.Ab(3),i.gc("ngIf",e.columns))},directives:[b.a,d.a,f.a,g.a,w.k,v.a],styles:[".ct-toolbar[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;width:100%;padding:0!important;margin:0!important}.ct-spacer[_ngcontent-%COMP%]{flex:1 1 auto}.mat-menu-item[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{margin-right:0!important}.ct-table-wrapper[_ngcontent-%COMP%]{width:100%;display:flex;position:relative}.ct-table-wrapper[_ngcontent-%COMP%]   ag-grid-angular[_ngcontent-%COMP%]{display:inline-block;flex:1 1 auto;height:calc(100vh - 118px)}.ct-table-wrapper[_ngcontent-%COMP%]   .ct-next-button[_ngcontent-%COMP%]{align-self:center}button[_ngcontent-%COMP%]{height:36px!important}button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px!important}.ct-order-date[_ngcontent-%COMP%]{height:36px;font-size:12px}"]}),t})();var S=o("PCNd"),A=o("vvyD"),C=o("3Pt+");let P=(()=>{class t{}return t.\u0275mod=i.Jb({type:t}),t.\u0275inj=i.Ib({factory:function(e){return new(e||t)},imports:[[w.c,S.a,v.b.withComponents(),A.a,C.h,C.q,n.g.forChild([{path:"",component:x,pathMatch:"full"}])]]}),t})()}}]);