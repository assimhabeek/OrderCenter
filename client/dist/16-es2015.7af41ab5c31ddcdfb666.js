(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{PAny:function(e,t,i){"use strict";i.d(t,"a",function(){return c});var r=i("AytR"),a=i("tk/3"),o=i("lJxs"),s=i("r4zg"),n=i("fXoL"),d=i("N+K7"),l=i("As+J");let c=(()=>{class e{constructor(e,t){this.httpService=e,this.skusService=t}getSKUs(){return this.skusService.getSkus().pipe(Object(o.a)(e=>{const t=e.data.reduce((e,t)=>{const i=e[t.skuType]||[];return i.push(t),e[t.skuType]=i,e},{});return Object.keys(t).reduce((e,i)=>(e[i]=this.addEmptyAndCompletedToSkus(t[i]),e),{})}))}getHeader(){return this.getSKUs().pipe(Object(o.a)(e=>{const t=e.HIGH_BEAM||this.addEmptyAndCompletedToSkus([]),i=e.LOW_BEAM||this.addEmptyAndCompletedToSkus([]),r=e.FOG_LIGHT||this.addEmptyAndCompletedToSkus([]);return this.buildHeader(t,i,r)}))}addEmptyAndCompletedToSkus(e){return e&&((e=e.map(e=>e.name)).unshift(s.a.NOT_EMPTY_CHAR),e.unshift("")),e||[]}buildHeader(e,t,i){return console.log(e),[{field:"year",headerName:"Vehicle Year"},{field:"make",headerName:"Vehicle Make"},{field:"model",headerName:"Vehicle Model"},{field:"highLowBeam",headerName:"High and LOW beam",cellEditor:"selectEditor",cellEditorParams:{elements:e.filter(e=>t.includes(e))}},{field:"highBeam",headerName:"High beam",cellEditor:"selectEditor",cellEditorParams:{elements:e}},{field:"lowBeam",headerName:"Low beam",cellEditor:"selectEditor",cellEditorParams:{elements:t}},{field:"fogLight",headerName:"Fog light",cellEditor:"selectEditor",cellEditorParams:{elements:i}}]}getRows(e){const t=Object.keys(e.request.filterModel).map(t=>({name:t,value:e.request.filterModel[t].filter})),i=JSON.stringify(t),o=(new a.c).set("start",e.request.startRow.toString()).set("end",e.request.endRow.toString()).set("filter",i).set("sortBy",e.request.sortModel[0]?e.request.sortModel[0].colId:"").set("sortDirection",e.request.sortModel[0]?e.request.sortModel[0].sort:"");this.httpService.getWithAuth(r.a.routes.vehicles,{params:o}).subscribe(t=>{if(t.status){e.successCallback(t.data,t.total);const i=[];e.columnApi.getAllColumns().forEach(e=>{i.push(e.colId)}),e.columnApi.autoSizeColumns(i,!1)}else e.failCallback()},t=>{e.failCallback()})}addRow(e){return this.httpService.postWithAuth(r.a.routes.vehicles,e)}updateCell(e){return this.httpService.putWithAuth(r.a.routes.vehicles,e).toPromise()}deleteRow(e){return this.httpService.deleteWithAuth(r.a.routes.vehicles+"/"+e)}getYear(){return this.httpService.get(r.a.routes.year)}getMake(e){return this.httpService.get(r.a.routes.make,{params:(new a.c).set("year",e)}).toPromise()}getModel(e,t){return this.httpService.get(r.a.routes.model,{params:(new a.c).set("year",e).set("make",t)}).toPromise()}}return e.\u0275fac=function(t){return new(t||e)(n.Vb(d.a),n.Vb(l.a))},e.\u0275prov=n.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},tYUl:function(e,t,i){"use strict";i.r(t),i.d(t,"ShopifyOrdersModule",function(){return O});var r=i("tyNb"),a=i("LRne"),o=i("fXoL"),s=i("AytR"),n=i("N+K7");let d=(()=>{class e{constructor(e){this.httpService=e}getShopifyProducts(){return this.httpService.getWithAuth(s.a.routes.shopifyOrders)}}return e.\u0275fac=function(t){return new(t||e)(o.Vb(n.a))},e.\u0275prov=o.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var l=i("MOE4"),c=i("0IaG"),h=i("A9p3"),p=i("3LUQ"),u=i("Wp6s"),m=i("bTqV"),g=i("Qu3c"),f=i("NFeN"),b=i("ofXK"),S=i("cWTo");function y(e,t){if(1&e&&(o.Rb(0,"div",4),o.Mb(1,"ag-grid-angular",5),o.Qb()),2&e){const e=o.cc();o.Ab(1),o.hc("gridOptions",e.options)("modules",e.modules)("rowData",e.rowData)}}let v=(()=>{class e{constructor(e,t,i,r,a){this.syncOrdersService=e,this.ordersService=t,this.dialog=i,this.confirmService=r,this.alertService=a,this.rowData=[],this.duplications=[],this.modules=[],this.disableImport=!1,this.defineHeader(),this.setupOptions()}onGridReady(e){this.gridApi=e.api,this.gridColumnApi=e.columnApi,this.refresh()}refresh(){this.syncOrdersService.getShopifyProducts().subscribe(e=>{e.status&&(this.rowData=e.data,this.gridApi.setRowData(e.data),this.setAutoSize(),this.duplications=e.duplication)})}defineHeader(){this.columns=[{field:"orderNo",headerName:"Order No",pinned:"left"},{field:"matchScore",headerName:"Match Score",pinned:"left"},{field:"quantity",headerName:"Quantity",type:"numericColumn"},{field:"productName",headerName:"Product name"},{field:"productTitle",headerName:"Product title"},{field:"highBeam",headerName:"High Beam"},{field:"lowBeam",headerName:"Low Beam"},{field:"fogLight",headerName:"Fog Light"},{field:"vehicleYear",headerName:"Vehicle Year"},{field:"vehicleMake",headerName:"Vehicle Make"},{field:"vehicleModel",headerName:"Vehicle Model"},{field:"vehicle",headerName:"Original"},{field:"orderNotes",headerName:"Order notes"},{field:"additionalDetails",headerName:"Additional details"},{field:"shippingName",headerName:"Shipping name"},{field:"shippingAddress1",headerName:"Shipping address1"},{field:"address2",headerName:"Address2"},{field:"shippingCity",headerName:"Shipping city"},{field:"shippingZip",headerName:"Shipping zip"},{field:"shippingProvince",headerName:"Shipping province"},{field:"shippingCountryCode",headerName:"Shipping country code"},{field:"shippingCountry",headerName:"Shipping country"},{field:"shippingPhone",headerName:"Shipping phone"},{field:"shippingCompany",headerName:"Shipping company"}]}setupOptions(){this.options={pagination:!1,defaultColDef:{filter:!1,sortable:!1,resizable:!0},animateRows:!0,rowClassRules:{"rag-green":"data.matchScore > 97","rag-amber":"data.matchScore >= 85 && data.matchScore <= 97","rag-red":"data.matchScore < 85 && data.matchScore > 0"},rowSelection:"single",columnDefs:this.columns,onGridReady:this.onGridReady.bind(this),paginationAutoPageSize:!0}}getRowStyle(e){return 100===e.node.data.MATCH_SCORE?{background:"rgba(0,219,0,0.1)"}:{background:"rgb(255,249,102)"}}insertOrders(){const e=this.duplications.length>0?this.askForConfirmation():Object(a.a)(!0);this.disableImport=!0,e.subscribe(e=>{e?this.ordersService.addAll(this.rowData).subscribe(e=>{e.status?this.onSuccess(e.message):(console.log(e),this.disableImport=!1,this.onError(e.message))},e=>{this.disableImport=!1,console.log(e),this.onError(e.message)}):this.disableImport=!1})}askForConfirmation(){return this.confirmService.requestConfirmation("Import confirmation","The Following ORDER No(s) already exist, Importing them my cause duplication, would you like to import them any way ? Duplicated Order No : "+this.duplications.join(" , "))}onSuccess(e){this.alertService.alertSuccess(e)}onError(e){this.alertService.alertError(e),this.refresh()}setAutoSize(){var e,t;const i=[];null===(e=this.gridColumnApi.getAllColumns())||void 0===e||e.forEach(e=>{i.push(e.colId)}),null===(t=this.gridColumnApi)||void 0===t||t.autoSizeColumns(i,!1)}}return e.\u0275fac=function(t){return new(t||e)(o.Lb(d),o.Lb(l.a),o.Lb(c.b),o.Lb(h.a),o.Lb(p.a))},e.\u0275cmp=o.Fb({type:e,selectors:[["ct-users-list"]],decls:8,vars:2,consts:[[1,"ct-toolbar","mat-elevation-z1"],["mat-icon-button","","color","primary","matTooltip","Import",3,"disabled","click"],["mat-icon-button","","matTooltip","Refresh",3,"click"],["class","ct-table-wrapper",4,"ngIf"],[1,"ct-table-wrapper"],[1,"ag-theme-balham",3,"gridOptions","modules","rowData"]],template:function(e,t){1&e&&(o.Rb(0,"mat-card",0),o.Rb(1,"button",1),o.Yb("click",function(){return t.insertOrders()}),o.Rb(2,"mat-icon"),o.xc(3,"publish"),o.Qb(),o.Qb(),o.Rb(4,"button",2),o.Yb("click",function(){return t.refresh()}),o.Rb(5,"mat-icon"),o.xc(6,"refresh"),o.Qb(),o.Qb(),o.Qb(),o.wc(7,y,2,3,"div",3)),2&e&&(o.Ab(1),o.hc("disabled",0===t.rowData.length||t.disableImport),o.Ab(6),o.hc("ngIf",t.columns))},directives:[u.a,m.a,g.a,f.a,b.k,S.a],styles:[".ct-toolbar[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;width:100%;padding:0!important;margin:0!important}.ct-spacer[_ngcontent-%COMP%]{flex:1 1 auto}.mat-menu-item[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{margin-right:0!important}.ct-table-wrapper[_ngcontent-%COMP%]{width:100%;display:flex;position:relative}.ct-table-wrapper[_ngcontent-%COMP%]   ag-grid-angular[_ngcontent-%COMP%]{display:inline-block;flex:1 1 auto;height:calc(100vh - 118px)}.ct-table-wrapper[_ngcontent-%COMP%]   .ct-next-button[_ngcontent-%COMP%]{align-self:center}button[_ngcontent-%COMP%]{height:36px!important}button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px!important}.ct-order-date[_ngcontent-%COMP%]{height:36px;font-size:12px}"]}),e})();var w=i("PCNd"),C=i("vvyD"),N=i("3Pt+");let O=(()=>{class e{}return e.\u0275mod=o.Jb({type:e}),e.\u0275inj=o.Ib({factory:function(t){return new(t||e)},imports:[[b.c,w.a,S.b.withComponents(),C.a,N.h,N.q,r.e.forChild([{path:"",component:v,pathMatch:"full"}])]]}),e})()}}]);