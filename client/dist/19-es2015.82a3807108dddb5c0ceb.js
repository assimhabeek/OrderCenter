(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{DPKD:function(t,e,r){"use strict";r.r(e),r.d(e,"ArchivedOrdersModule",function(){return P});var i=r("tyNb"),o=r("mrSG"),n=r("vkgz"),a=r("3Pt+"),s=r("GGDx"),c=r("mXS1"),l=r("r4zg"),d=r("fXoL"),u=r("ofXK"),h=r("bTqV");function b(t,e){if(1&t){const t=d.Sb();d.Rb(0,"button",1),d.Yb("click",function(){return d.oc(t),d.cc().onClick(1)}),d.xc(1,"UnArchive "),d.Qb()}}let p=(()=>{class t{agInit(t){this.params=t,this.isFileSet=null!=this.params.data.exportFile,this.value=+this.params.value}onClick(t){this.value=t,this.params.node.setDataValue(this.params.colDef,this.value)}refresh(t){return!0}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=d.Fb({type:t,selectors:[["ct-archive-button"]],decls:1,vars:1,consts:[["mat-flat-button","","color","accent",3,"click",4,"ngIf"],["mat-flat-button","","color","accent",3,"click"]],template:function(t,e){1&t&&d.wc(0,b,2,0,"button",0),2&t&&d.hc("ngIf",!e.isFileSet)},directives:[u.k,h.a],styles:["button[_ngcontent-%COMP%] {\n          font-size: 12px !important;\n          height: 24px !important;\n          padding: 2px !important;\n          line-height: 12px !important;\n        }"]}),t})();var m=r("MOE4"),f=r("0IaG"),g=r("u47x"),v=r("A9p3"),S=r("3LUQ"),R=r("Wp6s"),w=r("kmnG"),D=r("qFsG"),M=r("iadO"),C=r("STbY"),O=r("NFeN"),k=r("Qu3c"),x=r("cWTo");function F(t,e){if(1&t&&(d.Rb(0,"div",13),d.Mb(1,"ag-grid-angular",14),d.Qb()),2&t){const t=d.cc();d.Ab(1),d.hc("gridOptions",t.options)("modules",t.modules)("rowData",t.rowData)}}let A=(()=>{class t{constructor(t,e,r,i,o){this.ordersService=t,this.dialog=e,this._focusMonitor=r,this.confirmService=i,this.alertService=o,this.orderDateForm=new a.f({orderDate:new a.d(l.a.now())}),this.orderStatus=0,this.rowData=[],this.modules=[],this.modules=[c.a],this.loadHeaders().subscribe(t=>{this.setupOptions()},t=>{console.log(t),this.onError("Could not load grid info")})}onGridReady(t){this.gridApi=t.api,this.gridColumnApi=t.columnApi,this.addFilter({lastModification:{filter:l.a.toMysqlDate(this.orderDateForm.value.orderDate)}}),this.addFilter({orderStatus:{filter:l.a.orderStatus.ORDER_ARCHIVED}}),this.gridApi.setServerSideDatasource(this.ordersService),this.listenToOrderDateForm()}addFilter(t){if(this.gridApi){const e=this.gridApi.getFilterModel()?this.gridApi.getFilterModel():{};this.gridApi.setFilterModel(Object.assign(e,t))}}listenToOrderDateForm(){this.orderDateForm.valueChanges.subscribe(t=>{this.addFilter({lastModification:{filter:l.a.toMysqlDate(t.orderDate)}})})}loadHeaders(){return this.ordersService.getHeader().pipe(Object(n.a)(t=>{this.columns=t,this.columns[0].hide=!1,this.columns[0].editable=!0,this.columns[0].valueSetter=this.setValue.bind(this),this.columns[0].cellRenderer="archiveButtonRenderer"}))}setupOptions(){this.options={pagination:!1,tooltipShowDelay:0,defaultColDef:{sortable:!0,filter:!0,tooltipComponent:"tooltipRenderer",filterParams:{filterOptions:["contains"],defaultOption:"contains",suppressAndOrCondition:!0},resizable:!0,editable:!1},animateRows:!0,rowModelType:"serverSide",rowSelection:"single",cacheBlockSize:10,columnDefs:this.columns,onGridReady:this.onGridReady.bind(this),paginationAutoPageSize:!0,frameworkComponents:{tooltipRenderer:s.a,archiveButtonRenderer:p}}}refresh(){this.gridApi.purgeServerSideCache()}setValue(t){return Object(o.a)(this,void 0,void 0,function*(){const e={id:t.data.id,name:t.colDef.field,value:t.newValue};console.log(e),t.data[t.colDef.field]=t.newValue;const r=yield this.ordersService.updateCell(e);return(r.status?this.onSuccess.bind(this):this.onError.bind(this))(r.message),this.refresh(),r.status})}noRowSelected(){const t=this.gridApi?this.gridApi.getSelectedNodes():null;return!t||0===t.length}onSuccess(t){this.alertService.alertSuccess(t)}onError(t){this.alertService.alertError(t)}clearFilters(){this.orderDateForm.reset({orderDate:null}),this.gridApi.setFilterModel({orderStatus:{filter:l.a.orderStatus.ORDER_ARCHIVED}}),this.refresh()}}return t.\u0275fac=function(e){return new(e||t)(d.Lb(m.a),d.Lb(f.b),d.Lb(g.h),d.Lb(v.a),d.Lb(S.a))},t.\u0275cmp=d.Fb({type:t,selectors:[["ct-archived-orders"]],decls:31,vars:6,consts:[[1,"ct-toolbar","mat-elevation-z1"],[1,"ct-spacer"],[3,"formGroup"],[1,"ct-order-date"],["matInput","","formControlName","orderDate",3,"matDatepicker"],["matSuffix","",3,"for"],["picker",""],["mat-icon-button","",1,"ct-filter",3,"color","matMenuTriggerFor"],["mat-icon-button","","matTooltip","Refresh",3,"click"],["menu","matMenu"],["mat-menu-item","",3,"click"],["mat-icon-button","","matTooltip","Reset Filters","color","accent",3,"click"],["class","ct-table-wrapper",4,"ngIf"],[1,"ct-table-wrapper"],[1,"ag-theme-balham",3,"gridOptions","modules","rowData"]],template:function(t,e){if(1&t&&(d.Rb(0,"mat-card",0),d.Mb(1,"span",1),d.Rb(2,"div",2),d.Rb(3,"mat-form-field",3),d.Rb(4,"mat-label"),d.xc(5,"Choose a date"),d.Qb(),d.Mb(6,"input",4),d.Mb(7,"mat-datepicker-toggle",5),d.Mb(8,"mat-datepicker",null,6),d.Qb(),d.Qb(),d.Rb(10,"button",7),d.Rb(11,"mat-icon"),d.xc(12,"filter_alt"),d.Qb(),d.Qb(),d.Rb(13,"button",8),d.Yb("click",function(){return e.refresh()}),d.Rb(14,"mat-icon"),d.xc(15,"refresh"),d.Qb(),d.Qb(),d.Rb(16,"mat-menu",null,9),d.Rb(18,"button",10),d.Yb("click",function(){return e.orderStatus=0,e.refresh()}),d.Rb(19,"span"),d.xc(20,"Both"),d.Qb(),d.Qb(),d.Rb(21,"button",10),d.Yb("click",function(){return e.orderStatus=1,e.refresh()}),d.Rb(22,"span"),d.xc(23,"Pending"),d.Qb(),d.Qb(),d.Rb(24,"button",10),d.Yb("click",function(){return e.orderStatus=2,e.refresh()}),d.Rb(25,"span"),d.xc(26,"Queued"),d.Qb(),d.Qb(),d.Qb(),d.Rb(27,"button",11),d.Yb("click",function(){return e.clearFilters()}),d.Rb(28,"mat-icon"),d.xc(29,"cancel"),d.Qb(),d.Qb(),d.Qb(),d.wc(30,F,2,3,"div",12)),2&t){const t=d.mc(9),r=d.mc(17);d.Ab(2),d.hc("formGroup",e.orderDateForm),d.Ab(4),d.hc("matDatepicker",t),d.Ab(1),d.hc("for",t),d.Ab(3),d.hc("color",0!=e.orderStatus?"primary":"")("matMenuTriggerFor",r),d.Ab(20),d.hc("ngIf",e.columns)}},directives:[R.a,a.m,a.g,w.c,w.f,D.b,a.c,M.d,a.l,a.e,M.f,w.h,M.c,h.a,C.d,O.a,k.a,C.a,C.b,u.k,x.a],styles:[".ct-toolbar[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;width:100%;padding:0!important;margin:0!important}.ct-spacer[_ngcontent-%COMP%]{flex:1 1 auto}.mat-menu-item[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{margin-right:0!important}.ct-table-wrapper[_ngcontent-%COMP%]{width:100%;display:flex;position:relative}.ct-table-wrapper[_ngcontent-%COMP%]   ag-grid-angular[_ngcontent-%COMP%]{display:inline-block;flex:1 1 auto;height:calc(100vh - 118px)}.ct-table-wrapper[_ngcontent-%COMP%]   .ct-next-button[_ngcontent-%COMP%]{align-self:center}button[_ngcontent-%COMP%]{height:36px!important}button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px!important}.ct-order-date[_ngcontent-%COMP%]{height:36px;font-size:12px}"]}),t})();var Q=r("PCNd"),y=r("vvyD");let P=(()=>{class t{}return t.\u0275mod=d.Jb({type:t}),t.\u0275inj=d.Ib({factory:function(e){return new(e||t)},imports:[[u.c,Q.a,x.b.withComponents(),y.a,a.h,a.q,i.e.forChild([{path:"",component:A,pathMatch:"full"}])]]}),t})()}}]);