(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{GGDx:function(t,e,r){"use strict";r.d(e,"a",function(){return n});var o=r("r4zg"),i=r("fXoL");let n=(()=>{class t{agInit(t){this.data=t.api.getDisplayedRowAtIndex(t.rowIndex).data}parseDate(){return o.a.fromMysqlDateTime(this.data.lastModification).format("YYYY-MM-DD HH:mm:ss")}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Fb({type:t,selectors:[["tooltip-component"]],decls:3,vars:1,consts:[[1,"tooltip"]],template:function(t,e){1&t&&(i.Rb(0,"div",0),i.Rb(1,"p"),i.xc(2),i.Qb(),i.Qb()),2&t&&(i.Ab(2),i.zc(" ",e.parseDate()," "))},styles:["[_nghost-%COMP%] {\n                position: absolute;\n                width: 150px;\n                height: 70px;\n                pointer-events: none;\n                transition: opacity 1s;\n            }\n\n            .ag-tooltip-hiding[_nghost-%COMP%] {\n                opacity: 0;\n            }\n\n            .tooltip[_ngcontent-%COMP%]   p[_ngcontent-%COMP%] {\n                margin: 5px;\n                padding: 8px;\n                background: rgba(0, 0, 0, 0.9);\n                color: #eeeeee;\n                white-space: nowrap;\n            }"]}),t})()},PAny:function(t,e,r){"use strict";r.d(e,"a",function(){return u});var o=r("AytR"),i=r("tk/3"),n=r("lJxs"),a=r("r4zg"),s=r("fXoL"),l=r("N+K7"),c=r("As+J");let u=(()=>{class t{constructor(t,e){this.httpService=t,this.skusService=e}getSKUs(){return this.skusService.getSkus().pipe(Object(n.a)(t=>{const e=t.data.reduce((t,e)=>{const r=t[e.skuType]||[];return r.push(e),t[e.skuType]=r,t},{});return Object.keys(e).reduce((t,r)=>(t[r]=this.addEmptyAndCompletedToSkus(e[r]),t),{})}))}getHeader(){return this.getSKUs().pipe(Object(n.a)(t=>{const e=t.HIGH_BEAM||this.addEmptyAndCompletedToSkus([]),r=t.LOW_BEAM||this.addEmptyAndCompletedToSkus([]),o=t.FOG_LIGHT||this.addEmptyAndCompletedToSkus([]);return this.buildHeader(e,r,o)}))}addEmptyAndCompletedToSkus(t){return t&&((t=t.map(t=>t.name)).unshift(a.a.NOT_EMPTY_CHAR),t.unshift("")),t||[]}buildHeader(t,e,r){return console.log(t),[{field:"year",headerName:"Vehicle Year"},{field:"make",headerName:"Vehicle Make"},{field:"model",headerName:"Vehicle Model"},{field:"highLowBeam",headerName:"High and LOW beam",cellEditor:"selectEditor",cellEditorParams:{elements:t.filter(t=>e.includes(t))}},{field:"highBeam",headerName:"High beam",cellEditor:"selectEditor",cellEditorParams:{elements:t}},{field:"lowBeam",headerName:"Low beam",cellEditor:"selectEditor",cellEditorParams:{elements:e}},{field:"fogLight",headerName:"Fog light",cellEditor:"selectEditor",cellEditorParams:{elements:r}}]}getRows(t){const e=Object.keys(t.request.filterModel).map(e=>({name:e,value:t.request.filterModel[e].filter})),r=JSON.stringify(e),n=(new i.c).set("start",t.request.startRow.toString()).set("end",t.request.endRow.toString()).set("filter",r).set("sortBy",t.request.sortModel[0]?t.request.sortModel[0].colId:"").set("sortDirection",t.request.sortModel[0]?t.request.sortModel[0].sort:"");this.httpService.getWithAuth(o.a.routes.vehicles,{params:n}).subscribe(e=>{if(e.status){t.successCallback(e.data,e.total);const r=[];t.columnApi.getAllColumns().forEach(t=>{r.push(t.colId)}),t.columnApi.autoSizeColumns(r,!1)}else t.failCallback()},e=>{t.failCallback()})}addRow(t){return this.httpService.postWithAuth(o.a.routes.vehicles,t)}updateCell(t){return this.httpService.putWithAuth(o.a.routes.vehicles,t).toPromise()}deleteRow(t){return this.httpService.deleteWithAuth(o.a.routes.vehicles+"/"+t)}getYear(){return this.httpService.get(o.a.routes.year)}getMake(t){return this.httpService.get(o.a.routes.make,{params:(new i.c).set("year",t)}).toPromise()}getModel(t,e){return this.httpService.get(o.a.routes.model,{params:(new i.c).set("year",t).set("make",e)}).toPromise()}}return t.\u0275fac=function(e){return new(e||t)(s.Vb(l.a),s.Vb(c.a))},t.\u0275prov=s.Hb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},mrSG:function(t,e,r){"use strict";function o(t,e,r,o){return new(r||(r=Promise))(function(i,n){function a(t){try{l(o.next(t))}catch(e){n(e)}}function s(t){try{l(o.throw(t))}catch(e){n(e)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,s)}l((o=o.apply(t,e||[])).next())})}r.d(e,"a",function(){return o})},vasV:function(t,e,r){"use strict";r.r(e),r.d(e,"ExportQueueModule",function(){return _});var o=r("tyNb"),i=r("mrSG"),n=r("vkgz"),a=r("cp0P"),s=r("3Pt+"),l=r("GGDx"),c=r("r4zg"),u=r("fXoL"),d=r("ofXK"),h=r("bTqV");function p(t,e){if(1&t){const t=u.Sb();u.Rb(0,"button",2),u.Yb("click",function(){return u.oc(t),u.cc().onClick(2)}),u.xc(1,"Queue"),u.Qb()}}function m(t,e){if(1&t){const t=u.Sb();u.Rb(0,"button",3),u.Yb("click",function(){return u.oc(t),u.cc().onClick(1)}),u.xc(1,"UnQueue"),u.Qb()}}let b=(()=>{class t{agInit(t){this.params=t,this.value=+this.params.value}onClick(t){this.value=t,this.params.node.setDataValue(this.params.colDef,this.value)}refresh(t){return!0}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=u.Fb({type:t,selectors:[["ct-order-status-button"]],decls:2,vars:2,consts:[["mat-flat-button","","color","primary",3,"click",4,"ngIf"],["mat-flat-button","","color","warn",3,"click",4,"ngIf"],["mat-flat-button","","color","primary",3,"click"],["mat-flat-button","","color","warn",3,"click"]],template:function(t,e){1&t&&(u.wc(0,p,2,0,"button",0),u.wc(1,m,2,0,"button",1)),2&t&&(u.hc("ngIf",1==e.value),u.Ab(1),u.hc("ngIf",2==e.value))},directives:[d.k,h.a],styles:["button[_ngcontent-%COMP%] {\n            font-size: 12px !important;\n            height: 24px !important;\n            padding: 2px !important;\n            line-height: 12px !important;\n        }"]}),t})();var f=r("MOE4"),g=r("0IaG"),v=r("u47x"),w=r("A9p3"),S=r("3LUQ"),A=r("Wp6s"),R=r("kmnG"),k=r("qFsG"),C=r("iadO"),y=r("STbY"),x=r("NFeN"),M=r("Qu3c"),E=r("cWTo");function O(t,e){if(1&t&&(u.Rb(0,"div",15),u.Mb(1,"ag-grid-angular",16),u.Qb()),2&t){const t=u.cc();u.Ab(1),u.hc("gridOptions",t.options)("modules",t.modules)("rowData",t.rowData)}}let D=(()=>{class t{constructor(t,e,r,o,i){this.ordersService=t,this.dialog=e,this._focusMonitor=r,this.confirmService=o,this.alertService=i,this.orderDateForm=new s.f({orderDate:new s.d(c.a.now())}),this.orderStatus=0,this.rowData=[],this.modules=[],this.loadHeaders().subscribe(t=>{this.setupOptions()},t=>{console.log(t),this.onError("Could not load grid info")})}onGridReady(t){this.gridApi=t.api,this.gridColumnApi=t.columnApi,this.listenToOrderDateForm(),this.refresh()}listenToOrderDateForm(){this.orderDateForm.valueChanges.subscribe(t=>{this.gridApi.onFilterChanged()})}loadHeaders(){return this.ordersService.getHeader().pipe(Object(n.a)(t=>{this.columns=t,this.columns[0].hide=!1,this.columns[0].editable=!0,this.columns[0].valueSetter=this.setValue.bind(this),this.columns[0].cellRenderer="QueueButtonRenderer"}))}setupOptions(){this.options={pagination:!1,tooltipShowDelay:0,defaultColDef:{sortable:!0,filter:!1,tooltipComponent:"tooltipRenderer",filterParams:{filterOptions:["contains"],defaultOption:"contains",suppressAndOrCondition:!0},resizable:!0,editable:!1},animateRows:!0,rowSelection:"single",columnDefs:this.columns,onGridReady:this.onGridReady.bind(this),paginationAutoPageSize:!1,doesExternalFilterPass:this.filterRows.bind(this),isExternalFilterPresent:this.isExternalFilterPresent.bind(this),frameworkComponents:{tooltipRenderer:l.a,QueueButtonRenderer:b}}}refresh(){0===this.orderStatus?this.loadBoth():this.loadOne()}loadBoth(){Object(a.a)([this.ordersService.getQueueOrders(c.a.orderStatus.ORDER_ACTIVE),this.ordersService.getQueueOrders(c.a.orderStatus.ORDER_QUEUED)]).subscribe(t=>{t[0].status&&t[1].status?(this.gridApi.setRowData(t[0].data.concat(t[1].data)),this.setAutoSize()):this.onError("Couldn't load the data")},t=>{this.onError(t.message)})}loadOne(){this.ordersService.getQueueOrders(this.orderStatus).subscribe(t=>{t.status?(this.gridApi.setRowData(t.data),this.setAutoSize()):this.onError("Couldn't load the data")},t=>{this.onError(t.message)})}setAutoSize(){var t,e;const r=[];null===(t=this.gridColumnApi.getAllColumns())||void 0===t||t.forEach(t=>{r.push(t.colId)}),null===(e=this.gridColumnApi)||void 0===e||e.autoSizeColumns(r,!1)}setValue(t){return Object(i.a)(this,void 0,void 0,function*(){const e={id:t.data.id,name:t.colDef.field,value:t.newValue};console.log(e),t.data[t.colDef.field]=t.newValue;const r=yield this.ordersService.updateCell(e);return(r.status?this.onSuccess.bind(this):this.onError.bind(this))(r.message),r.status})}autoFocusNext(t,e){!t.errors&&e&&this._focusMonitor.focusVia(e,"program")}autoFocusPrev(t,e){t.value.length<1&&this._focusMonitor.focusVia(e,"program")}noRowSelected(){const t=this.gridApi?this.gridApi.getSelectedNodes():null;return!t||0===t.length}onSuccess(t){this.alertService.alertSuccess(t)}onError(t){this.alertService.alertError(t)}queueAll(){this.confirmService.requestConfirmation("Queue all orders","Are you sure you want to add all the visible orders to the export queue.").subscribe(t=>{t&&this.updateAllRows(c.a.orderStatus.ORDER_QUEUED)})}unQueueAll(){this.confirmService.requestConfirmation("UnQueue all orders","Are you sure you want to remove all the visible orders from the export queue.").subscribe(t=>{t&&this.updateAllRows(c.a.orderStatus.ORDER_ACTIVE)})}updateAllRows(t){let e;e=[],this.gridApi.forEachNode(t=>{e.push(t.data.id)}),0!==e.length?this.ordersService.queueAll({value:t,data:e}).subscribe(t=>{t.status?(this.refresh(),this.onSuccess(t.message)):(this.refresh(),this.onError(t.message))},t=>{this.onError(t.message)}):this.onError("Nothing to queue")}isExternalFilterPresent(){return null!=this.orderDateForm.value.orderDate}filterRows(t){return this.filterByDate(t.data.lastModification,this.orderDateForm.value.orderDate)}filterByDate(t,e){return t.includes(c.a.toMysqlDate(e))}clearFilters(){this.orderDateForm.reset({orderDate:null}),this.orderStatus=0,this.gridApi.setFilterModel({}),this.refresh()}}return t.\u0275fac=function(e){return new(e||t)(u.Lb(f.a),u.Lb(g.b),u.Lb(v.h),u.Lb(w.a),u.Lb(S.a))},t.\u0275cmp=u.Fb({type:t,selectors:[["ct-order-list"]],decls:36,vars:6,consts:[[1,"ct-toolbar","mat-elevation-z1"],["mat-flat-button","","color","primary",1,"ct-toolbar-btn",3,"click"],["mat-flat-button","","color","warn",1,"ct-toolbar-btn",3,"click"],[1,"ct-spacer"],[3,"formGroup"],[1,"ct-order-date"],["matInput","","formControlName","orderDate",3,"matDatepicker"],["matSuffix","",3,"for"],["picker",""],["mat-icon-button","",1,"ct-filter",3,"color","matMenuTriggerFor"],["mat-icon-button","","matTooltip","Refresh",3,"click"],["menu","matMenu"],["mat-menu-item","",3,"click"],["mat-icon-button","","matTooltip","Reset Filters","color","accent",3,"click"],["class","ct-table-wrapper",4,"ngIf"],[1,"ct-table-wrapper"],[1,"ag-theme-balham",3,"gridOptions","modules","rowData"]],template:function(t,e){if(1&t&&(u.Rb(0,"mat-card",0),u.Rb(1,"div"),u.Rb(2,"button",1),u.Yb("click",function(){return e.queueAll()}),u.xc(3," Queue All "),u.Qb(),u.Rb(4,"button",2),u.Yb("click",function(){return e.unQueueAll()}),u.xc(5," UnQueue All "),u.Qb(),u.Qb(),u.Mb(6,"span",3),u.Rb(7,"div",4),u.Rb(8,"mat-form-field",5),u.Rb(9,"mat-label"),u.xc(10,"Choose a date"),u.Qb(),u.Mb(11,"input",6),u.Mb(12,"mat-datepicker-toggle",7),u.Mb(13,"mat-datepicker",null,8),u.Qb(),u.Qb(),u.Rb(15,"button",9),u.Rb(16,"mat-icon"),u.xc(17,"filter_alt"),u.Qb(),u.Qb(),u.Rb(18,"button",10),u.Yb("click",function(){return e.refresh()}),u.Rb(19,"mat-icon"),u.xc(20,"refresh"),u.Qb(),u.Qb(),u.Rb(21,"mat-menu",null,11),u.Rb(23,"button",12),u.Yb("click",function(){return e.orderStatus=0,e.refresh()}),u.Rb(24,"span"),u.xc(25,"Both"),u.Qb(),u.Qb(),u.Rb(26,"button",12),u.Yb("click",function(){return e.orderStatus=1,e.refresh()}),u.Rb(27,"span"),u.xc(28,"Pending"),u.Qb(),u.Qb(),u.Rb(29,"button",12),u.Yb("click",function(){return e.orderStatus=2,e.refresh()}),u.Rb(30,"span"),u.xc(31,"Queued"),u.Qb(),u.Qb(),u.Qb(),u.Rb(32,"button",13),u.Yb("click",function(){return e.clearFilters()}),u.Rb(33,"mat-icon"),u.xc(34," cancel "),u.Qb(),u.Qb(),u.Qb(),u.wc(35,O,2,3,"div",14)),2&t){const t=u.mc(14),r=u.mc(22);u.Ab(7),u.hc("formGroup",e.orderDateForm),u.Ab(4),u.hc("matDatepicker",t),u.Ab(1),u.hc("for",t),u.Ab(3),u.hc("color",0!=e.orderStatus?"primary":"")("matMenuTriggerFor",r),u.Ab(20),u.hc("ngIf",e.columns)}},directives:[A.a,h.a,s.m,s.g,R.c,R.f,k.b,s.c,C.d,s.l,s.e,C.f,R.h,C.c,y.d,x.a,M.a,y.a,y.b,d.k,E.a],styles:[".ct-toolbar[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;width:100%;padding:0!important;margin:0!important}.ct-spacer[_ngcontent-%COMP%]{flex:1 1 auto}.mat-menu-item[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{margin-right:0!important}.ct-table-wrapper[_ngcontent-%COMP%]{width:100%;display:flex;position:relative}.ct-table-wrapper[_ngcontent-%COMP%]   ag-grid-angular[_ngcontent-%COMP%]{display:inline-block;flex:1 1 auto;height:calc(100vh - 118px)}.ct-table-wrapper[_ngcontent-%COMP%]   .ct-next-button[_ngcontent-%COMP%]{align-self:center}.ct-toolbar-btn[_ngcontent-%COMP%]{margin:4px;font-size:12px!important;height:24px!important;padding:2px 4px!important;line-height:12px!important}button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px!important}.ct-order-date[_ngcontent-%COMP%]{height:36px;font-size:12px}"]}),t})();var Q=r("PCNd"),P=r("vvyD");let _=(()=>{class t{}return t.\u0275mod=u.Jb({type:t}),t.\u0275inj=u.Ib({factory:function(e){return new(e||t)},imports:[[d.c,Q.a,E.b.withComponents(),P.a,s.h,s.q,o.e.forChild([{path:"",component:D,pathMatch:"full"}])]]}),t})()}}]);